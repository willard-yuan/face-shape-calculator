{"version":3,"file":"builder.js","sources":["../../src/builder.ts"],"sourcesContent":["import { assignDeep } from \"./utils\";\nimport { Vibrant } from \"./\";\nimport type { ImageClass, ImageSource } from \"@vibrant/image\";\n\nimport type { Palette } from \"@vibrant/color\";\nimport type { Options } from \"./options\";\n\n/**\n * Helper class for change configurations and create a Vibrant instance. Methods of a Builder instance can be chained like:\n *\n * @example\n * ```javascript\n * Vibrant.from(src)\n *   .quality(1)\n *   .clearFilters()\n *   // ...\n *   .getPalette()\n *   .then((palette) => {})\n * ```\n */\nexport class Builder {\n\tprivate _src: ImageSource;\n\tprivate _opts: Partial<Options>;\n\n\t/**\n\t * Arguments are the same as `Vibrant.constructor`.\n\t */\n\tconstructor(src: ImageSource, opts: Partial<Options> = {}) {\n\t\tthis._src = src;\n\t\tthis._opts = assignDeep({}, Vibrant.DefaultOpts, opts);\n\t}\n\n\t/**\n\t * Sets `opts.colorCount` to `n`.\n\t * @returns this `Builder` instance.\n\t */\n\tmaxColorCount(n: number): Builder {\n\t\tthis._opts.colorCount = n;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets `opts.maxDimension` to `d`.\n\t * @returns this `Builder` instance.\n\t */\n\tmaxDimension(d: number): Builder {\n\t\tthis._opts.maxDimension = d;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a filter function\n\t * @returns this `Builder` instance.\n\t */\n\taddFilter(name: string): Builder {\n\t\tif (!this._opts.filters) {\n\t\t\tthis._opts.filters = [name];\n\t\t} else {\n\t\t\tthis._opts.filters.push(name);\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes a filter function.\n\t * @returns this `Builder` instance.\n\t */\n\tremoveFilter(name: string): Builder {\n\t\tif (this._opts.filters) {\n\t\t\tconst i = this._opts.filters.indexOf(name);\n\t\t\tif (i > 0) this._opts.filters.splice(i);\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Clear all filters.\n\t * @returns this `Builder` instance.\n\t */\n\tclearFilters(): Builder {\n\t\tthis._opts.filters = [];\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets `opts.quality` to `q`.\n\t * @returns this `Builder` instance.\n\t */\n\tquality(q: number): Builder {\n\t\tthis._opts.quality = q;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Specifies which `Image` implementation class to use.\n\t * @returns this `Builder` instance.\n\t */\n\tuseImageClass(imageClass: ImageClass): Builder {\n\t\tthis._opts.ImageClass = imageClass;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Sets `opts.generator` to `generator`\n\t * @returns this `Builder` instance.\n\t */\n\tuseGenerator(generator: string, options?: any): Builder {\n\t\tif (!this._opts.generators) this._opts.generators = [];\n\t\tthis._opts.generators.push(\n\t\t\toptions ? { name: generator, options } : generator,\n\t\t);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Specifies which `Quantizer` implementation class to use\n\t * @returns this `Builder` instance.\n\t */\n\tuseQuantizer(quantizer: string, options?: any): Builder {\n\t\tthis._opts.quantizer = options ? { name: quantizer, options } : quantizer;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Builds and returns a `Vibrant` instance as configured.\n\t */\n\tbuild(): Vibrant {\n\t\treturn new Vibrant(this._src, this._opts);\n\t}\n\n\t/**\n\t * Builds a `Vibrant` instance as configured and calls its `getPalette` method.\n\t */\n\tgetPalette(): Promise<Palette> {\n\t\treturn this.build().getPalette();\n\t}\n}\n"],"names":[],"mappings":";;AAoBO,MAAM,QAAQ;AAAA;AAAA;AAAA;AAAA,EAOpB,YAAY,KAAkB,OAAyB,IAAI;AAC1D,SAAK,OAAO;AACZ,SAAK,QAAQ,WAAW,CAAI,GAAA,QAAQ,aAAa,IAAI;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOtD,cAAc,GAAoB;AACjC,SAAK,MAAM,aAAa;AACjB,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,aAAa,GAAoB;AAChC,SAAK,MAAM,eAAe;AACnB,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,UAAU,MAAuB;AAC5B,QAAA,CAAC,KAAK,MAAM,SAAS;AACnB,WAAA,MAAM,UAAU,CAAC,IAAI;AAAA,IAAA,OACpB;AACD,WAAA,MAAM,QAAQ,KAAK,IAAI;AAAA,IAAA;AAEtB,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,aAAa,MAAuB;AAC/B,QAAA,KAAK,MAAM,SAAS;AACvB,YAAM,IAAI,KAAK,MAAM,QAAQ,QAAQ,IAAI;AACzC,UAAI,IAAI,EAAG,MAAK,MAAM,QAAQ,OAAO,CAAC;AAAA,IAAA;AAEhC,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,eAAwB;AAClB,SAAA,MAAM,UAAU,CAAC;AACf,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,QAAQ,GAAoB;AAC3B,SAAK,MAAM,UAAU;AACd,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,cAAc,YAAiC;AAC9C,SAAK,MAAM,aAAa;AACjB,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,aAAa,WAAmB,SAAwB;AACvD,QAAI,CAAC,KAAK,MAAM,WAAiB,MAAA,MAAM,aAAa,CAAC;AACrD,SAAK,MAAM,WAAW;AAAA,MACrB,UAAU,EAAE,MAAM,WAAW,YAAY;AAAA,IAC1C;AACO,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAOR,aAAa,WAAmB,SAAwB;AACvD,SAAK,MAAM,YAAY,UAAU,EAAE,MAAM,WAAW,YAAY;AACzD,WAAA;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA,EAMR,QAAiB;AAChB,WAAO,IAAI,QAAQ,KAAK,MAAM,KAAK,KAAK;AAAA,EAAA;AAAA;AAAA;AAAA;AAAA,EAMzC,aAA+B;AACvB,WAAA,KAAK,MAAM,EAAE,WAAW;AAAA,EAAA;AAEjC;"}